<script type="text/javascript">
   function toggleVisibility(id) {
     const element = document.getElementById(id);
     if(element.style.display == 'block')
        element.style.display = 'none';
     else
        element.style.display = 'block';
   }

   function inputSourceHandler(selectionId, textFieldId) {
     const selectionElement = document.getElementById(selectionId);
     const textFieldElement = document.getElementById(textFieldId);
     switch (selectionElement.value) {
       case 'textbox': {
         textFieldElement.style.display = 'block';
         break;
       }

       case 'input': {
         textFieldElement.style.display = 'none';
         break;
       }

       default: {
         textFieldElement.style.display = 'none';
       }
     }
   }
</script>

<script type="text/javascript">
    RED.nodes.registerType("sensor write in", {
        category: "input",
        defaults: {
            uuid: {value: "", required: true},
            service: {type: "lesley-service", required: true},
            uri: {value: "", required: true},
            resourceType: {value: "integer", required: true},
            valueSource: {value: "textbox", required: true},
            resourceValue: {value: "integer"}
        },
        inputs: 1,
        outputs: 1,
        color: "rgb(204, 204, 0)",
        label: function () {
			return "sensor write";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        icon: "bridge.png",
    });
</script>

<script type="text/x-red" data-template-name="sensor write in">
    <div class="form-row">
        <label for="node-input-uuid">UUID</label>
        <input type="text" id="node-input-uuid" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
    </div>
    <div class="form-row">
        <label for="node-input-service">Service</label>
        <input type="text" id="node-input-service">
    </div>
    <div class="form-row">
        <label for="node-input-uri">Resource path</label>
        <input type="text" id="node-input-uri">
    </div>
    <div class="form-row">
        <label for="node-input-valueSource">Value source:</label>
        <select id="node-input-valueSource" onchange="inputSourceHandler('node-input-valueSource', 'resourceValueRegion')">
            <option value='textbox'>Textbox</option>
            <option value='input'>Input</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-resourceType">Resource type:</label>
        <select id="node-input-resourceType">
            <option value='integer'>Integer</option>
            <option value='float'>Float</option>
            <option value='string'>String</option>
            <option value='boolean'>Boolean</option>
            <option value='opaque'>Opaque</option>
        </select>
    </div>
    <div class="form-row" id="resourceValueRegion">
        <label for="node-input-resourceValue">Resource value</label>
        <input id="node-input-resourceValue">
    </div>
</script>

<script type="text/x-red" data-help-name="sensor write in">
<p>This node sends resource write requests when it receives input.</p>
<p>Message structure:</p>
<ul>
	<li>msg.payload : Payload, value</li>
</ul>
</script>
